## Préambule
L'objectif de ce document est de présenter l'installation du plugin Zigate sur un NAS Synology


## Pre-requis

* Avant tout, Python doit ête installé : voir [Domoticz Python page](https://www.domoticz.com/wiki/Synology_installation_folder)
* Le paquet Domoticz pour Synology a installé est la version 'avec Puthon'. Vous pouvez la télécharger depuis Jahdal. Au moment de l'écriture de ces lignes, c'est la version v4.10717 avec Python 3.5.1. 
* Le Module Python du Package manager doit être installé. Voir [Python Module](https://www.synology.com/en-uk/dsm/packages/PythonModule)
* Le paquet GitHub server pour Synology doit être installé. 
* Installer le paquet Git Server via Diskstation. La partie Serveur du paquet Git Server n'est pas nécessaire, juste le 'git command' (pas de configurations spécifiques).
* Vous devez avoir les accès root/admin avec la commande 'sudo'.
* Si besoin, les drivers pour la Zigate sont disponible sur le site [jadahl.com](http://www.jadahl.com/drivers_6.2/)


## Installation du plugin

Démarrer une session Putty 

Se loguer

Aller jusqu'au dossier plugins de Domoticz :

cd /volume1/@appstore/domoticz/var/plugins

Faire un clone du Git du plugin Zigate dans un nouveau dossier :

sudo git clone https://github.com/sasu-drooz/Domoticz-Zigate.git Zigate

Arréter et redémarer Domoticz depuis le gestionnaire de paquet.

--------------------------------------------------------

Conitnuer avec la configuration du plugin Zigate dans DomoticZ.


Dans DomoticZ, aller dans Configuration puis Matériel

Sélectionner le plugin Zigate dans la liste, indiquer un nom et sélectionner le port usb correspondant à la Zigate.
Pick Zigate Plugin from the list, name it and set the wright USB port.

At the first boot you have to set “Erase Persistent Data” to True to build a new network.

Set Permit Join to value 255 to search for a unlimited time for new devices

Click Add and check the log. When the USB TTL is in Permit Join mode the blue and red LEDs are flickering. Now you can add devices the usual way. For example press and hold 3 secs the button at the Aqara sensor.

When you are done adding devices set the permit join value to something lower than 255. 

## Known issue

There is a known issue on Syno which makes Domoticz to crash when starting the plugin. 
You need to disable the feature to check for plugin and firmware update availability.

You have to edit the file Domoticz-Zigate/Conf/PluginConf-xx.json
and add the following line

"internetAccess": 0,

the best is to add it in the middle of the file, so you don't break the all file syntax
